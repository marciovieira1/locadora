(function(f){var k=f.telerik;k.slider=function(m,n){var o=f(m);this.element=m;n.distance=n.maxValue-n.minValue;f.extend(this,n);n.position=this.orientation=="horizontal"?"left":"bottom";n.size=this.orientation=="horizontal"?"width":"height";n.orientation=this.orientation;j(m,n);this.wrapper=o.closest(".t-slider");this.trackDiv=this.wrapper.find(".t-slider-track");k.slider.setTrackDivWidth(this.wrapper,n);this.maxSelection=this.trackDiv[n.size]();if(n.tickFrequency!=0){k.slider.setItemsWidth(this.wrapper,this.trackDiv,n);k.slider.setItemsTitle(this.wrapper,n)}this.pixelStepsArray=k.slider.getPixelSteps(this.trackDiv,n);var l={element:m,dragHandle:this.wrapper.find(".t-draghandle"),orientation:n.orientation,size:n.size,position:n.position,owner:this};this._setValueInRange(n.val);this[n.enabled?"enable":"disable"]();new k.slider.Selection(l);new k.slider.Drag(l);this.keyMap={37:g(n.smallStep),40:g(n.smallStep),39:h(n.smallStep),38:h(n.smallStep),35:d(n.maxValue),36:d(n.minValue),33:h(n.largeStep),34:g(n.largeStep)};k.bind(this,{slide:this.onSlide,change:this.onChange,load:this.onLoad})};f.extend(k.slider,{setTrackDivWidth:function(n,o){var m=n.find(".t-slider-track");var l=parseFloat(m.css(o.position),10)*2;m[o.size]((n[o.size]()-2)-l)},setItemsWidth:function(t,p,m){var l=Math.floor(m.distance/m.tickFrequency),r=t.find(".t-tick"),q=0,s=p[m.size]();var o=this.calculateItemsWidth(t,m,l);if(m.orientation=="horizontal"){for(var n=0;n<r.length-2;n++){f(r[n+1])[m.size](o[n])}}else{o=o.reverse();for(var n=2;n<r.length;n++){f(r[n-1])[m.size](o[n])}}if(m.orientation=="horizontal"){f(r[0]).addClass("t-first")[m.size](o[l]);f(r[r.length-1]).addClass("t-last")[m.size](o[l-1])}else{f(r[r.length-1]).addClass("t-first")[m.size](o[0]);f(r[0]).addClass("t-last")[m.size](o[1])}if(m.distance%m.tickFrequency!=0&&m.orientation=="vertical"){for(var n=0;n<o.length;n++){q+=o[n]}t.find(".t-slider-items").css("padding-top",29+(s-q))}},setItemsTitle:function(n,o){var p=n.find(".t-tick"),m=o.minValue;if(o.orientation=="horizontal"){for(var l=0;l<p.length;l++){f(p[l]).attr("title",m);m+=o.tickFrequency}}else{for(var l=p.length-1;l>=0;l--){f(p[l]).attr("title",m);m+=o.tickFrequency}}},calculateItemsWidth:function(s,n,m){var r=parseFloat(s.find(".t-slider-track").css(n.size))+1,o=r/n.distance;if((n.distance/n.tickFrequency)-Math.floor(n.distance/n.tickFrequency)>0){r-=((n.distance%n.tickFrequency)*o)}var l=r/m,q=new Array();for(var p=0;p<m-1;p++){q[p]=l}q[m-1]=q[m]=l/2;return this.roudWidths(q)},roudWidths:function(l){var m=0;for(i=0;i<l.length;i++){m+=(l[i]-Math.floor(l[i]));l[i]=Math.floor(l[i])}m=Math.round(m);return this.addAdditionalSize(m,l)},addAdditionalSize:function(m,l){if(m==0){return l}var n=parseFloat(l.length-1)/parseFloat(m==1?m:m-1);result=new Array();for(var o=0;o<m;o++){l[parseInt(Math.round(n*o))]+=1}return l},getPixelSteps:function(o,m){var p=parseInt(o.css(m.size));var r=new Array();var n=(p/m.distance)*m.smallStep;var q=p;var l=0;while(q!=0){r[l]=n;q-=n;q=q.toFixed(3);l++;if(q<=n){r[l]=q;q=0}}return this.roudWidths(r)},getValueFromPosition:function(n,o,q){var l=Math.max(q.smallStep*(q.maxSelection/q.distance),0),p,r=(l/2);if(q.orientation=="horizontal"){p=n-o.startPoint}else{p=o.startPoint-n}if(q.maxSelection-((parseInt(q.maxSelection%l)-3)/2)<p){return q.maxValue}p+=r;var m=0;if(p>=r){while(p>l){p-=l;m+=q.smallStep}}return parseFloat((q.minValue+m).toFixed(3))},getDragableArea:function(m,n,l){var p=m.offset().left,o=m.offset().top;return{startPoint:l=="horizontal"?p:o+n,endPoint:l=="horizontal"?p+n:o}}});function h(l){return function(m){return m+l}}function g(l){return function(m){return m-l}}function d(l){return function(){return l}}k.slider.prototype={enable:function(){this.wrapper.removeAttr("disabled").removeClass("t-state-disabled").addClass("t-state-default");var l=f.proxy(function(p){var o=this.orientation=="horizontal"?p.pageX:p.pageY;var n=k.slider.getDragableArea(this.trackDiv,this.maxSelection,this.orientation);this._update(k.slider.getValueFromPosition(o,n,this))},this);this.wrapper.find(".t-tick").bind("click",l).end().find(".t-slider-track").bind("click",l);if(this.showButtons){var m=f.proxy(function(n,o){if(n.which==1){this._setValueInRange(this.val+(o*this.smallStep));this.timeout=setTimeout(f.proxy(function(){this.timer=setInterval(f.proxy(function(){this._setValueInRange(this.val+(o*this.smallStep))},this),60)},this),200)}},this);this.wrapper.find(".t-button").unbind("mousedown").unbind("mouseup").bind("mouseup",f.proxy(function(n){this._clearTimer()},this)).unbind("mouseover").bind("mouseover",function(n){f(n.currentTarget).addClass("t-state-hover")}).unbind("mouseout").bind("mouseout",f.proxy(function(n){f(n.currentTarget).removeClass("t-state-hover");this._clearTimer()},this)).eq(0).bind("mousedown",f.proxy(function(n){m(n,1)},this)).end().eq(1).bind("mousedown",f.proxy(function(n){m(n,-1)},this))}this.wrapper.find(".t-draghandle").bind({keydown:f.proxy(this._keydown,this)});this.enabled=true},disable:function(){this.wrapper.attr("disabled","disabled").removeClass("t-state-default").addClass("t-state-disabled");var l=k.preventDefault;this.wrapper.find(".t-button").unbind("mousedown").bind("mousedown",l).unbind("mouseup").bind("mouseup",l).unbind("mouseleave").bind("mouseleave",l).unbind("mouseover").bind("mouseover",l);this.wrapper.find(".t-tick").unbind("click").end().find(".t-slider-track").unbind("click");this.wrapper.find(".t-draghandle").unbind("keydown").bind("keydown",l);this.enabled=false},_update:function(l){var m=this.value()!=l;this.value(l);if(m){k.trigger(this.element,"change",{value:this.val})}},value:function(l){l=parseFloat(parseFloat(l,10).toFixed(3),10);if(isNaN(l)){return this.val}if(l>=this.minValue&&l<=this.maxValue){f(this.element).val(l);if(this.val!=l){this.val=l;this.refresh()}}},refresh:function(){k.trigger(this.element,"t:moveSelection",{value:this.val})},_clearTimer:function(l){clearTimeout(this.timeout);clearInterval(this.timer)},_keydown:function(l){if(l.keyCode in this.keyMap){this._setValueInRange(this.keyMap[l.keyCode](this.val));l.preventDefault()}},_setValueInRange:function(l){l=parseFloat(parseFloat(l,10).toFixed(3),10);if(isNaN(l)){this._update(this.minValue);return}l=Math.max(l,this.minValue);l=Math.min(l,this.maxValue);this._update(l)}};k.slider.Selection=function(n){var o=f(n.element);function m(q){var r=q-n.owner.minValue;i=0,selection=0;while(r>0){r-=n.owner.smallStep;selection+=n.owner.pixelStepsArray[i];i++}var p=n.owner.trackDiv.find(".t-slider-selection");var s=parseInt(n.dragHandle[n.size]()/2,10)+1;p[n.size](selection);n.dragHandle.css(n.position,selection-s)}m(parseFloat(o.val(),10));var l=function(p){m(parseFloat(p.value,10))};o.bind({change:l,slide:l,"t:moveSelection":l})};k.slider.Drag=function(m){m.dragHandleSize=m.dragHandle[m.size]();f.extend(this,m);var l="";switch(m.type){case"leftHandle":l=".t-draghandle:first";break;case"rightHandle":l=".t-draghandle:last";break;default:l=".t-draghandle";break}new k.draggable({distance:0,owner:m.owner.wrapper[0],selector:l,scope:m.element.id,start:f.proxy(this.start,this),drag:f.proxy(this.drag,this),stop:f.proxy(this.stop,this)})};k.slider.Drag.prototype={start:function(l){if(!this.owner.enabled){return false}this.val=parseFloat(f(this.element).val());this.dragableArea=k.slider.getDragableArea(this.owner.trackDiv,this.owner.maxSelection,this.orientation);this.step=Math.max(this.owner.smallStep*(this.owner.maxSelection/this.owner.distance),0);this.selectionStart=this.owner.selectionStart;this.selectionEnd=this.owner.selectionEnd;if(this.type){this.owner._setZIndex(this.type)}this.oldVal=this.val},drag:function(l){if(this.orientation=="horizontal"){this.val=this.horizontalDrag(l)}else{this.val=this.verticalDrag(l)}if(this.oldVal!=this.val){this.oldVal=this.val;if(this.type){if(this.type=="leftHandle"){if(this.val<this.selectionEnd){this.selectionStart=this.val}else{this.selectionStart=this.selectionEnd=this.val}}else{if(this.val>this.selectionStart){this.selectionEnd=this.val}else{this.selectionStart=this.selectionEnd=this.val}}k.trigger(this.element,"slide",{values:[this.selectionStart,this.selectionEnd]})}else{k.trigger(this.element,"slide",{value:this.val})}}},stop:function(l){if(l.keyCode==27){this.owner.refresh()}else{if(this.owner.wrapper.find(".t-draghandle").length==2){this.owner._update(this.selectionStart,this.selectionEnd)}else{this.owner._update(this.val)}}return false},horizontalDrag:function(l){var m=0;if(this.dragableArea.startPoint<l.pageX&&l.pageX<this.dragableArea.endPoint){m=k.slider.getValueFromPosition(l.pageX,this.dragableArea,this.owner)}else{if(l.pageX>=this.dragableArea.endPoint){m=this.owner.maxValue}else{m=this.owner.minValue}}return m},verticalDrag:function(l){var m=0;if(this.dragableArea.startPoint>l.pageY&&l.pageY>this.dragableArea.endPoint){m=k.slider.getValueFromPosition(l.pageY,this.dragableArea,this.owner)}else{if(l.pageY<=this.dragableArea.endPoint){m=this.owner.maxValue}else{m=this.owner.minValue}}return m}};function b(m,l){var n=f(l);var q=m.orientation=="horizontal"?" t-slider-horizontal":" t-slider-vertical";var o;if(m.tickPlacement=="bottomRight"){o=" t-slider-bottomright"}else{if(m.tickPlacement=="topLeft"){o=" t-slider-topleft"}}var p=m.style?m.style:n.attr("style");return new k.stringBuilder().cat("<div ").cat("class='t-widget t-slider").cat(q).catIf(" ",n.attr("class"),n.attr("class")).cat("'").cat(p?" style='"+p+"'":" style='"+m.size+": 200px;'").cat(">").cat("<div class='t-slider-wrap").catIf(" t-slider-buttons",m.showButtons).catIf(o,o).cat("'></div></div>").string()}function c(n,m){var l;isHorizontal=n.orientation=="horizontal";if(m=="increase"){l=isHorizontal?"t-arrow-next":"t-arrow-up"}else{l=isHorizontal?"t-arrow-prev":"t-arrow-down"}return new k.stringBuilder().cat("<a ").cat("class='t-button ").cat("t-button-"+m).cat("'><span class='t-icon ").cat(l).cat("' title='").cat(n[m+"ButtonTitle"]).cat("'>").cat(n[m+"ButtonTitle"]).cat("</span></a>").string()}function a(l){return new k.stringBuilder().cat("<ul class='t-reset t-slider-items'>").rep("<li class='t-tick'>&nbsp;</li>",Math.floor(l.distance/l.tickFrequency)+1).cat("</ul>").string()}function e(l){var m=l.is("input")?1:2;return new k.stringBuilder().cat("<div class='t-slider-track'>").cat("<div class='t-slider-selection'><!-- --></div>").cat("<a href='javascript:void(0)' class='t-draghandle' title='Drag'>Drag</a>").catIf("<a href='javascript:void(0)' class='t-draghandle t-draghandle1' title='Drag'>Drag</a>",m>1).cat("</div>").string()}function j(l,m){var n=f(l);n.wrap(b(m,l)).hide();if(m.showButtons){n.before(c(m,"increase")).before(c(m,"decrease"))}if(m.tickFrequency!=0){n.before(a(m))}n.before(e(n))}f.fn.tSlider=function(l){return k.create(this,{name:"tSlider",init:function(m,n){return new k.slider(m,n)},options:l})};f.fn.tSlider.defaults={enabled:true,minValue:0,maxValue:10,val:0,smallStep:1,largeStep:5,showButtons:true,increaseButtonTitle:"Increase",decreaseButtonTitle:"Decrease",orientation:"horizontal",tickPlacement:"both",tickFrequency:0};k.rangeSlider=function(n,o){var p=f(n);this.element=n;o.distance=o.maxValue-o.minValue;f.extend(this,o);o.position=this.orientation=="horizontal"?"left":"bottom";o.size=this.orientation=="horizontal"?"width":"height";j(n,o);this.wrapper=p.closest(".t-slider");this.trackDiv=this.wrapper.find(".t-slider-track");k.slider.setTrackDivWidth(this.wrapper,o);this.maxSelection=this.trackDiv[o.size]();if(o.tickFrequency!=0){k.slider.setItemsWidth(this.wrapper,this.trackDiv,o);k.slider.setItemsTitle(this.wrapper,o)}this.pixelStepsArray=k.slider.getPixelSteps(this.trackDiv,o);this._correctValues(this.selectionStart,this.selectionEnd);var m={element:n,type:"leftHandle",dragHandle:this.wrapper.find(".t-draghandle:first"),orientation:o.orientation,size:o.size,position:o.position,owner:this};new k.slider.Drag(m);new k.rangeSlider.Selection(m);var l={element:n,type:"rightHandle",dragHandle:this.wrapper.find(".t-draghandle:last"),orientation:o.orientation,size:o.size,position:o.position,owner:this};new k.slider.Drag(l);this[o.enabled?"enable":"disable"]();this.keyMap={37:g(o.smallStep),40:g(o.smallStep),39:h(o.smallStep),38:h(o.smallStep),35:d(o.maxValue),36:d(o.minValue),33:h(o.largeStep),34:g(o.largeStep)};k.bind(this,{slide:this.onSlide,change:this.onChange,load:this.onLoad})};k.rangeSlider.prototype={enable:function(){this.wrapper.removeAttr("disabled").removeClass("t-state-disabled").addClass("t-state-default");var l=f.proxy(function(p){var n=this.orientation=="horizontal"?p.pageX:p.pageY;var m=k.slider.getDragableArea(this.trackDiv,this.maxSelection,this.orientation);var o=k.slider.getValueFromPosition(n,m,this);if(o<this.selectionStart){this._setValueInRange(o,this.selectionEnd)}else{if(o>this.selectionEnd){this._setValueInRange(this.selectionStart,o)}else{if(o-this.selectionStart<=this.selectionEnd-o){this._setValueInRange(o,this.selectionEnd)}else{this._setValueInRange(this.selectionStart,o)}}}},this);this.wrapper.find(".t-tick").bind("click",l).end().find(".t-slider-track").bind("click",l);this.wrapper.find(".t-draghandle").eq(0).bind({keydown:f.proxy(function(m){this._keydown(m,true)},this)}).end().eq(1).bind({keydown:f.proxy(function(m){this._keydown(m,false)},this)});this.enabled=true},disable:function(){this.wrapper.attr("disabled","disabled").removeClass("t-state-default").addClass("t-state-disabled");this.wrapper.find(".t-tick").unbind("click").end().find(".t-slider-track").unbind("click");this.wrapper.find(".t-draghandle").unbind("keydown").bind("keydown",k.preventDefault);this.enabled=false},_keydown:function(o,l){var n=this.selectionStart,m=this.selectionEnd;if(o.keyCode in this.keyMap){if(l){n=this.keyMap[o.keyCode](n);if(n>m){m=n}}else{m=this.keyMap[o.keyCode](m);if(m<n){n=m}}this._setValueInRange(n,m);o.preventDefault()}},_update:function(m,l){var o=this.values();var n=o[0]!=m||o[1]!=l;this.values(m,l);if(n){k.trigger(this.element,"change",{values:[m,l]})}},values:function(m,l){var n=[this.selectionStart,this.selectionEnd];m=parseFloat(parseFloat(m,10).toFixed(3),10);if(isNaN(m)){return n}l=parseFloat(parseFloat(l,10).toFixed(3),10);if(isNaN(l)){return n}if(m>=this.minValue&&m<=this.maxValue&&l>=this.minValue&&l<=this.maxValue){if(this.selectionStart!=m||this.selectionEnd!=l){f(this.element).find("input").eq(0).val(m).end().eq(1).val(l);this.selectionStart=m;this.selectionEnd=l;this.refresh()}}},refresh:function(){k.trigger(this.element,"t:moveSelection",{values:[this.selectionStart,this.selectionEnd]});if(this.selectionStart==this.maxValue&&this.slectionEnd==this.maxValue){this._setZIndex("leftHandle")}},_setValueInRange:function(l,m){l=Math.max(l,this.minValue);l=Math.min(l,this.maxValue);m=Math.max(m,this.minValue);m=Math.min(m,this.maxValue);if(this.selectionStart==this.maxValue&&this.slectionEnd==this.maxValue){this._setZIndex("leftHandle")}this._update(l,m)},_correctValues:function(m,l){if(m>=l){this._setValueInRange(l,m)}else{this._setValueInRange(m,l)}},_setZIndex:function(n){var p=this.wrapper.find(".t-draghandle");var l=p.eq(0);var o=p.eq(1);var m="z-index";if(n=="leftHandle"){l.css(m,"1");o.css(m,"")}else{l.css(m,"");o.css(m,"1")}}};k.rangeSlider.Selection=function(p){function o(s){var w=s[0]-p.owner.minValue,v=s[1]-p.owner.minValue,t=0,u=0,r=0;while(w>0){w-=p.owner.smallStep;t+=p.owner.pixelStepsArray[r];r++}r=0;while(v>0){v-=p.owner.smallStep;u+=p.owner.pixelStepsArray[r];r++}var q=p.owner.wrapper.find(".t-draghandle");var x=parseInt(q.eq(0)[p.size]()/2,10)+1;q.eq(0).css(p.position,t-x).end().eq(1).css(p.position,u-x);m(t,u)}function m(t,r){var s=0,u=0;if(t<r){s=r-t;u=t}else{s=t-r;u=r}var q=p.owner.trackDiv.find(".t-slider-selection");q[p.size](s);q.css(p.position,u-1)}var n=f(p.owner.element).find("input");o([parseFloat(n[0].getAttribute("value"),10),parseFloat(n[1].getAttribute("value"),10)]);var l=function(q){o(q.values)};f(p.owner.element).bind({change:l,slide:l,"t:moveSelection":l})};f.fn.tRangeSlider=function(l){return k.create(this,{name:"tRangeSlider",init:function(m,n){return new k.rangeSlider(m,n)},options:l})};f.fn.tRangeSlider.defaults={enabled:true,minValue:0,maxValue:10,slectionStart:0,slectionEnd:10,smallStep:1,largeStep:5,orientation:"horizontal",tickPlacement:"both",tickFrequency:0}})(jQuery);